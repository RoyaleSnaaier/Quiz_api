# Display errors on for debugging purposes
php_flag display_errors on

# Enable mod_rewrite for friendly URLs
RewriteEngine On

# Don't rewrite if it's a directory (folder) or file
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f

# Route /posts and /posts/ID to the correct file in the pages directory
RewriteRule ^posts/([0-9]+)$ pages/posts.php?postId=$1 [L]
RewriteRule ^posts$ pages/posts.php [L]

# Add support for /pages/posts/ID route
RewriteRule ^pages/posts/([0-9]+)$ pages/posts.php?postId=$1 [L]
RewriteRule ^pages/posts$ pages/posts.php [L]

# Remove .php extension from URLs - this needs to come last
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^.]+)\.php
RewriteRule ^/?(.*)\.php$ /$1 [L,R=301]

# Internally add .php extension to accessed files if they exist
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ $1.php [L,QSA]
